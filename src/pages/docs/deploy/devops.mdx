---
title: 开发环境部署 - DevOps 远程开发
description: 华炎魔方是 Salesforce Developer Experience (DX) 的开源替代方案，将低代码技术与 DevOps 工具结合 ，帮助企业以更快速度交付更高质量的软件，实现低代码敏捷开发的新高度。
---

华炎魔方是 [Salesforce Developer Experience (DX)](https://developer.salesforce.com/developer-centers/developer-experience) 的开源替代方案，将低代码技术与 DevOps 工具结合 ，帮助企业以更快速度交付更高质量的软件，实现低代码敏捷开发的新高度。

[查看视频简介 >](/embed/videos/devops)

## 直播课程

[查看视频简介 >](/embed/videos/live-course-devops) \n 华炎魔方低代码学院直播课，低代码DevOps平台操作实战，带大家一起启动远程开发环境，实操演示整个华炎魔方低代码DevOps开发生命周期过程。

## 启动远程开发环境

[查看视频简介 >](/embed/videos/devops-launch)

可以参考该视频快速启动一个远程开发环境来试用华炎魔方。

### 注册DevOps账户

请在 [华炎魔方DevOps平台](https://gitlab.steedos.cn/) 注册账户并使用浏览器登录该账户，注册成功后即可在该平台使用包含 GitLab DevOps 和 Gitpod 的远程开发服务，您可以免费试用一个月，商业用户请 [联系我们](https://www.steedos.cn/company/contact-us) 为您激活账户。

### 一键启动

 ![](https://console.steedos.cn/api/files/images/vGYghkBqFNoy7NcLM)请先点击上述截图中红框按钮Fork，即“派生” GitLab中国区域云服务 上的 [华炎魔方模板项目](https://gitlab.steedos.cn/steedos/steedos-project-template)，后续我们就可以把开发后的代码提交到Git仓库。

项目Fork好后，点击上述截图红框位置的”Gitpod”按钮即可一键启动远程开发环境。

 ![](https://console.steedos.cn/api/files/images/m59GEDNmorBfDfxPx)为了方便快速启动远程开发环境，我们在 [GitLab 中国区域云服务](https://gitlab.steedos.cn/) 集成了一键启用按钮，使用Chrome浏览器访问该云服务上任何一个Git仓库主页时都可以看到一个名为”Gitpod”的按钮，点击它即可一键启动远程开发环境。


<alert type="info">
我们在启动过程中偶尔会遇到界面一直不动，这是界面没有实时更新造成的，只要刷新浏览器即可。

</alert>

启动远程开发环境后会自动执行以下操作，它可以节省开发人员大量时间：

* 自动访问项目地址：[https://vscode.steedos.cn/#{之前Fork下来的Git仓库地址}](https://vscode.steedos.cn/#%7B%E4%B9%8B%E5%89%8DFork%E4%B8%8B%E6%9D%A5%E7%9A%84Git%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80%7D) 来启动远程开发环境，可以把`#`号后面的Git仓库地址换成您希望运行的任何华炎魔方项目的Git仓库地址来启动其远程开发环境。
* 自动分配远程服务器资源创建一个新的Workspace。
* 把#号后面的Git仓库地址中的项目克隆到Workspace中并重定向到Workspace访问地址。
* 自动从网络下载并加载华炎魔方Docker镜像。
* 自动安装和配置MongoDB数据库，并以集群模式启动数据库。
* 自动安装、配置和启动Redis数据库。
* 自动安装必要的VS Code插件，包括元数据同步、简体中文语言包等。
* 自动执行 `yarn` 安装项目依赖的NPM包。
* 自动执行 `yarn start` 启动项目。

在浏览器上运行Gitpod启用远程开发环境打开项目时，我们会遇到Gitpod自动打开新的浏览器窗口时被拦截，也会经常遇到需要拷贝本地文件到Gitpod项目中的情况，这些也都可以通过浏览器设置来实现，详情请参考当前文档底部的附录小节 [关于Gitpod](#%E5%85%B3%E4%BA%8Egitpod)。


<alert type="info">
由于VS Code插件安装是异步执行的，所以有可能会遇到未安装成功的情况，此时只要手动安装开发环境中推荐的VS Code插件即可。

</alert>



<alert type="warning">
请注意，第一次启动远程开发环境后，如果想打开之前启动过的项目，应该 [打开历史工作区](#%E6%89%93%E5%BC%80%E5%8E%86%E5%8F%B2%E5%B7%A5%E4%BD%9C%E5%8C%BA)，而不是再次点击上面提到的Gitpod按钮来启动新的开发环境。

</alert>

### 运行项目

 ![](https://console.steedos.cn/api/files/images/sazPKv6DaPzXBBy8T)每次启动远程开发环境会自动运行项目，第一次启动项目，会显示激活华炎魔方的初始化界面，激活后就可以使用初始账户登录系统。

### 激活华炎魔方

请在 [华炎魔方客户门户](https://console.steedos.cn/) 注册账户，使用浏览器登录该账户后再分别新建我的魔方和私有部署记录。

 ![](https://console.steedos.cn/api/files/images/NfyTzYsEYjgN2JLBm)点击刚新建好的私有部署记录详细界面右上角的“复制激活参数”按钮可以把相关环境变量配置复制下来。

在我的魔方中设置的初始密码就是初始化华炎魔方项目时自动创建的初始管理员账户的默认密码。

#### 输入激活参数

上面“复制激活参数”按钮复制的内容，已经包含了激活华炎魔方需要的相关环境变量，我们把它粘贴到之前运行项目时看到的初始化界面的输入框中，提交后即可激活华炎魔方了。

 ![](https://console.steedos.cn/api/files/images/g6tbcZSF5EQBfXQnQ)在激活过程中会自动执行以下操作：

* 自动把包括用于激活华炎魔方、同步元数据等各种环境变量保存到`.env.local`文件中。
* 连接 [华炎魔方客户门户](https://console.steedos.cn/) 服务激活本地的华炎魔方。
* 自动下载不限制用户数、不限制访问时间的许可证。
* 在本地魔方项目中自动创建管理员账户并设置其初始密码。
* 获取当前魔方ID已购买的软件包并把它们自动安装到本地魔方项目中。
* 自动跳转到登录界面。

激活成功后，我们在登录界面输入之前在 [华炎魔方客户门户](https://console.steedos.cn/) 注册账户时填写的手机号和新建 我的魔方 时设置的初始密码即可进入系统主界面。


<alert type="info">
登录界面要输入的手机号和密码都是在 [华炎魔方客户门户](https://console.steedos.cn/) 填写的，不是 [华炎魔方DevOps平台](https://gitlab.steedos.cn/) 上注册的账户。

</alert>

### 项目访问地址

 ![](https://console.steedos.cn/api/files/images/Qhh97XGesm3ipvjyg)如果项目运行完成后没有自动打开浏览器窗口访问项目的话，可以手动在浏览器中输入Gitpod-Workspaces访问地址并加上要访问的项目端口号作为前缀即可访问它。

比如假设之前开启的远程开发环境打开的Workspaces访问地址为`https://gold-stingray-81a30kah.ws.vscode.steedos.cn/`，我们只要输入地址 `https://5000-gold-stingray-81a30kah.ws.vscode.steedos.cn/`即可访问刚运行起来的项目。

需要注意的是，默认情况下，使用Gitpod启动远程开发环境后，连续30分钟不移动鼠标操作其VS Code界面的话，远程服务会自动停止以释放相关资源，如果连续更长时间，比如数天甚至数周不访问的话，包括程序代码和数据库数据在内的所有资源都会被销毁，请参阅本文档底部的 “关于Gitpod - Pin” 小节了解如何锁定开发环境，避免数据丢失。

## 软件包开发流程

以下软件包开发流程，描述了在华炎魔方中软件包的开发生命周期，它是实现华炎魔方整个DevOps开发生命周期管理中最重要的环节之一。[                                                                                  ![软件包&元数据 示意图](https://console.steedos.cn/api/files/images/duh3tECd387Sz5i8J "软件包&元数据 示意图")](https://console.steedos.cn/api/files/images/duh3tECd387Sz5i8J)

### 可视化开发

基于华炎魔方可视化开发，只要点击鼠标就能开发企业级应用，所以在项目开发初期，我们可以把开发人员与不懂代码的业务人员组织起来，充分讨论分解项目需求后，让业务人员分担大部分可视化开发工作。

可以参考 [华炎魔方官网文档](/docs) 的管理员向导相关教程在界面上开发业务需求，目前可以在可视化界面上进行开发的业务功能主要包括：

* 数据建模
* 配置数据访问权限
* 配置自动化业务流程
* 设置审批王
* 导入数据
* 设计业务报表
* 与企业微信及钉钉客户端集成
* 连接外部数据源与现有业务系统集成

 ![](https://console.steedos.cn/api/files/images/2ykszh5pWkjvmcwCJ)在界面上做可视化开发时可以随时查看和测试效果，而不需要重启服务，以上截屏动画描述了在可视化界面进行数据建模的大致过程。

### 同步为代码

虽然可视化开发能实现很多业务功能，但是有些复杂业务场景还是需要开发人员参与才能解决，所以项目开发中期，可以让开发人员介入，他们能通过华炎魔方代码同步工具把业务人员做的可视化配置作为元数据同步到代码中，并且在此基础上编写代码来进一步实现各种复杂的业务需求。

 ![](https://console.steedos.cn/api/files/images/A6Y6bqGDMXbby4bFu)以上截屏动画描述了把可视化界面上创建的对象和字段相关元数据同步为代码的大致过程，更多细节请参考文档 [同步元数据](/docs/developer/getting-started#%E5%90%8C%E6%AD%A5%E5%85%83%E6%95%B0%E6%8D%AE)，推荐使用 [多软件包开发](/docs/developer/getting-started#%E5%A4%9A%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%BC%80%E5%8F%91) 模式，并在同步元数据前 [设置元数据同步路径](/docs/developer/getting-started#%E8%AE%BE%E7%BD%AE%E5%85%83%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E8%B7%AF%E5%BE%84) 为相关软件包文件夹。

Gitpod启动远程开发环境打开华炎魔方模板项目时会自动安装同步元数据需要的Steedos Cli命令行工具和VS Code插件，并且会自动把初始化界面中输入的环境变量参数配置到项目中，您可以直接在项目中使用元数据同步工具而不需要额外做任何配置。

### 代码开发

接下来开发人员可以在相关软件包文件夹中编写代码，通过低代码的方式实现只有编写代码才能实现的相关业务需求。

每一个华炎魔方项目都是一个标准的Node.js工程，开发人员可以在项目中以传统编码方式开发应用程序，更可以参考 [华炎魔方官网文档](/docs) 的开发人员向导相关教程，基于华炎魔方以下出色的低代码能力实现各种高级业务逻辑，在成倍提升开发效率的同时交付出更高质量的项目成果。

* 代码级的元数据配置：比如表单公式、复杂过滤条件，表单级联脚本，操作按钮显示条件等各种只能通过代码才能实现的复杂元数据配置功能，详情请参考文档 [开发人员快速向导](/docs/developer/getting-started)。
* 代码级的元数据类型：比如触发器，服务端路由API等，详情请参考文档 [开发人员快速向导](/docs/developer/getting-started)。
* GraphQL API接口：在代码中可以调用业务对象的 [GraphQL API接口](/docs/developer/graphql-api)，这些接口在对象创建的时候就自动生成了，并且它们都集成了 [华炎魔方权限引擎](/docs/admin/permission_set)。
* ObjectQL：在代码中可以使用 [ObjectQL内核语法](/docs/developer/objectql) 来实现业务对象增删改查，且所有数据操作语句都集成了 [华炎魔方权限引擎](/docs/admin/permission_set)。
* 代码级报表设计工具：使用 [JsReport报表](/docs/developer/jsreport)，可以编写JavaScript代码来开发设计出各种报表模板。
* 对象级微服务架构：与NodeRed无缝集成，能快速深度整合现有业务系统，详情请参阅文档 [与现有业务系统整合](https://beta.steedos.cn/docs/developer/node-red)。

代码编写完成后可以通过重新加载软件包的方式来让整个软件包“重启”，而不需要重启华炎魔方服务来测试这些代码，详情请参考文档 [重新加载软件包](/docs/developer/package#%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BD%E8%BD%AF%E4%BB%B6%E5%8C%85)，不过重启服务也是一种有效测试方式。

 ![](https://console.steedos.cn/api/files/images/mKc7NmHkgzxZZLgcT)以上截屏动画描述了使用代码编写触发器来校验数据的合法性，当填写的数据不合法时拦截数据提交。

### 提交代码

功能开发并测试通过后，可以在远程开发环境中使用VS Code的源代码管理工具来把代码提交到Git仓库，详情请参阅本文档底部教程 [源代码版本管理](#%E6%BA%90%E4%BB%A3%E7%A0%81%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86)。

 ![](https://console.steedos.cn/api/files/images/LrgxAtiuqoXm87Svc)以上截屏动画描述了使用VS Code的源代码管理工具提交之前开发的会议应用代码到Git仓库的过程。

### 发布软件包

项目开发完成并测试通过后，可以发布为软件包，发布后的软件包可以在测试环境或生产环境中直接安装使用，还可以在华炎魔方应用市场中定价售卖发布后的软件包，详情请参考教程 [软件包发布与安装](https://www.steedos.cn/docs/developer/package)。

### 部署到测试环境

当软件包开发完成后，需要部署到测试环境来测试相关功能，我们可以重新启动一个全新的 远程开发环境 专门用于测试。

#### 更新代码测试

无论是远程开发环境提交代码后需要进行阶段测试还是工程完工后需要完整测试，亦或是修正BUG后的某个版本需要在上线前测试确认，我们都随时可以安排测试人员在独立的远程测试环境中更新最新代码来测试相关功能。

#### 安装软件包测试

 ![](https://console.steedos.cn/api/files/images/8JRAzNLbvbL2kjBFo)相对于更新代码测试，安装软件包来测试更进一步，也只有这种测试方式才是面向生产环境部署的终极测试手段。

当项目工程拆分为一个或多个软件包发布后，我们更推荐的严格测试方式是，重新创建一个全新的华炎魔方模板项目，然后为其启动一个 远程开发环境 并使用安装软件包的方式来测试相关功能。

### 部署到生产环境

基于华炎魔方软件包开发的应用，不需要像传统开发项目一样部署整个项目代码到生产环境，而只需要把发布后的软件包直接安装到部署好的华炎魔方生产环境即可，这里所说的生产环境可以是 [华炎魔方客户门户](https://console.steedos.cn/) 这样的多租户云环境，也可以是基于 [私有部署 - Docker （推荐）](https://beta.steedos.cn/docs/deploy/deploy-docker)部署的私有华炎魔方项目生产环境。

也正是得益于基于华炎魔方软件包的DevOps开发方式，任何个人开发者或开发团队开发的软件包都可以直接放到 [华炎魔方应用](https://beta.steedos.cn/collections/steedos-packages) 市场售卖。

## 多人协同开发

在中大型软件开发项目中往往需要数人甚至数十人进行团队协同开发，上面我们描述了华炎魔方DevOps开发生命周期中软件包的开发流程，该流程对于单人开发模式和多人协同开发模式一样适用。

### 可视化协同开发

项目开发初期，充分讨论分解项目需求后，我们可以把业务需求分拆成不同的业务对象，然后把业务人员组织起来大家分工协作，每个业务人员分别负责一个或数个业务对象的可视化开发工作，大家访问同一个远程开发环境运行起来的魔方项目，按计划同时在界面上开发各自负责的业务对象。

### 源代码协同开发

与可视化开发一样，在项目中期，多人协同开发一样可以把业务需求分拆后，把开发人员组织起来大家分工协作，不过开发人员是各自运行自己的远程开发环境来开发和调试自己负责的部分，并使用VS Code的源代码管理工具来提交代码并更新其他人提交的代码来协同开发项目。

### 分包协同开发

在业务需求很繁杂和庞大时，尤其是在大型软件开发项目中，我们推荐把业务人员和开发人员进行分组，每组成员各自负责其中某个功能模块的开发和测试，我们正好可以把每个功能模块按软件包来划分，一个软件包负责一个功能模块，并让它们分别管理自己的软件包开发周期，最后在测试环境和生产环境中分别安装这些软件包来测试和部署相应的模块。


Debug模式调试

使用Gitpod启动远程开发环境，在调试开发华炎魔方项目时，可以像在本地开发一样使用VS Code的Debug调试工具调试程序代码。

 ![](https://console.steedos.cn/api/files/images/qRvCB4YK3yHK27ru7)以上截屏动画演示了如何以Debug模式启动项目，华炎魔方是使用JavaScript编写的标准Node.js应用，所以不需要其他额外的配置，只要在VS Code中新建一个“JavaScript Debug Terminal”，并在该命令行窗口中执行 `yarn start` 命令启动服务就可以直接开始断点调试了。

 ![](https://console.steedos.cn/api/files/images/dcnC3Lwt44sKGne5X)以上截屏动画演示了断点调式华炎魔方程序大致过程，关于如何使用VS Code断点调试请参考其官网教程 [Visual Studio Code Debugging](https://code.visualstudio.com/Docs/editor/debugging)，还可以参考 [Node.js debugging in VS Code](https://code.visualstudio.com/docs/nodejs/nodejs-debugging) 了解更多Node.js调试技巧。

## 源代码版本管理

使用Gitpod启动远程开发环境，在调试开发华炎魔方项目时，可以像在本地开发一样使用VS Code的源代码管理工具来更新、提交代码，或者查看代码提交历史等，只要启动Gitpod远程开发环境相关插件会在初始化时自动安装好，您可以直接使用它们，相关使用教程请参考 [Visual Studio Code 源代码管理官网教程](https://code.visualstudio.com/docs/editor/versioncontrol)。

## 关于Gitpod

Gitpod是一个在线IDE，点击任何 [GitLab 中国区域云服务](https://gitlab.steedos.cn/) 项目主页上的 Gitpod 按钮即可一键启动远程开发环境。

在几秒钟之内，Gitpod就可以为您提供一个完整的开发环境，包括一个VS Code驱动的IDE和一个可以由项目定制化配置的云Linux容器。

Gitpod旨在取代本地桌面开发，所以我们强烈推荐使用它来启动远程开发环境，以免去本地安装开发环境的繁琐过程，如果需要本地安装开发环境请参考文档：

* [开发环境部署 - Windows](/docs/deploy/deploy-windows)
* [开发环境部署 - Mac](/docs/deploy/deploy-mac)

### 浏览器设置

为了在使用Gitpod时获得最好的体验，我们建议您将 Gitpod 列入白名单，以获取您的浏览器上的以下权限：

* 将内容从剪贴板粘贴到Gitpod工作区。
* 弹出窗口，在一个新的浏览器选项卡访问您开发的服务。

以下是在Chrome浏览器中的配置方法，[Gitpod官网](https://www.gitpod.io) 有详细说明，详情请参阅： <https://www.gitpod.io/docs/configure/browser-settings>。

设置好后你甚至可以把本地文件拖动到Chrome浏览器上Gitpod工作区中相关文件夹内来复制上传文件，大大提高开发效率。

#### 剪贴板

1. 在chrome浏览器中输入地址 `chrome://settings/content/clipboard` 来打开“剪贴板”设置界面。
2. 在右侧内容界面中找到“允许查看您的剪贴板”栏，点击其旁边的“添加”按钮。
3. 在弹出的“添加网站”窗口中输入`[*.]vscode.steedos.cn` 然后点击添加按钮即可。

#### 弹出式窗口和重定向

1. 在chrome浏览器中输入地址 `chrome://settings/content/popups` 来打开“弹出式窗口和重定向”设置界面。
2. 在右侧内容界面中找到“允许发送弹出式窗口并使用重定向”栏，点击其旁边的“添加”按钮。
3. 在弹出的“添加网站”窗口中输入`[*.]vscode.steedos.cn` 然后点击添加按钮即可。

### 使用本地VS Code

 ![](https://console.steedos.cn/api/files/images/wWCvfb5NQRjM3AE7m)默认情况下，使用Gitpod启用远程开发环境是打开浏览器运行的，我们可以访问 [Gitpod官网个人设置页面](https://vscode.steedos.cn/preferences) 勾选 `Open in Desktop IDE` 选项来开启使用本地VS Code打开远程Gitpod工作区的功能，该功能开启后，就可以使用本地VS Code打开Gitpod工作区了，使用浏览器还是本地VS Code主要看个人习惯，两种方式并没有太大区别。

### Pin

默认情况下，使用Gitpod启动远程开发环境后，连续30分钟不移动鼠标操作其VS Code界面的话，远程服务会自动停止以释放相关资源，但是会保留硬盘资源，如果连续更长时间，比如数天甚至数周不访问的话，该工作区内的所有硬盘资源都会被销毁，这意味着上次访问该工作区时未提交到Git仓库的所有代码以及数据库中数据都将丢失，而且无法再在工作区列表访问该工作区。

 ![](https://console.steedos.cn/api/files/images/LHBaya7fFaTP9pHBs)

我们可以在 [Gitpod 中国区域云服务的Workspaces页面](https://vscode.steedos.cn/workspaces)  看到之前打开过的所有Gitpod工作区，在该列表上找到希望不自动释放资源的Workspace，点击右侧下拉菜单按钮，在展开的菜单中勾选“Pin”选项即可把该Gitpod工作区设置为不自动释放资源。

Pin后的Gitpod工作区，不但会保留未提交到Git仓库的代码，而且在开发环境中安装过的依赖项以及数据库数据等都会持续留存于开发环境中，一般不用担心数据丢失问题，但是我们还是建议大家尽量及时把代码提交到Git仓库中。

### 打开历史工作区

我们可以在 [Gitpod 中国区域云服务的Workspaces页面](https://vscode.steedos.cn/workspaces)  看到之前打开过的所有Gitpod工作区，在该列表上找到希望再启动的工作区，点击右侧下拉菜单按钮，在展开的菜单中点击“Open”选项即可重新启动该工作区远程开发环境。因为第一次启动该工作区时已经部署好了开发环境，所以再次进入该工作区时启动服务速度要比新开工作区时快很多。

### 下载

我们可以在 [Gitpod 中国区域云服务的Workspaces页面](https://vscode.steedos.cn/workspaces) 看到之前打开过的所有Gitpod工作区列表，在该列表上找到想下载的Workspace，点击右侧下拉菜单按钮，在展开的菜单中点击“Download”选项即可把该Gitpod工作区下载到本地，然后把下载之后的文件重命名，在其后缀名加上 `.tar.gz` 就可以解压缩，解压缩后的文件是 `/workspace` 文件夹中的所有文件，其中也包括MongoDB数据库文件。

### 访问MongoDB

使用Gitpod远程启动华炎魔方模板工作区的开发环境中已经预先为VS Code安装了名为 [MongoDB for VS Code](https://github.com/mongodb-js/vscode) 的插件，可以使用该插件来访问华炎魔方工作区连接的MongoDB数据库，以便查看数据库中的数据调试程序。

### 重启远程开发环境

有时我们会因为某些原因希望重启整个远程开发环境而不希望开启全新的远程开发环境，比如端口被占用无法正常启动服务时可能重启整个开发环境服务是比较快捷的方式。

要重启远程开发环境，请在 [Gitpod 中国区域云服务的Workspaces页面](https://vscode.steedos.cn/workspaces) 中浏览目前打开的所有Gitpod工作区，然后在列表上找到希望重启服务的那条记录，点击其右侧下拉菜单按钮，在展开的菜单中勾选“Stop”选项即可停止该Gitpod工作区，待停止成功后重新点击其中的“Open”选项即可重新打开该工作区。

### 重启VS Code

有时我们会因为某些原因希望重启VS Code，在浏览器上的Gitpod远程开发环境中，只需要刷新浏览器即可重启VS Code，而不需要重启整个Gitpod开发环境，非常方便快捷。