---
title: 如何创建自定义应用程序？
description: 对象对应的是数据库的表。我们也可以把对象当作是一个业务分类来理解，如“合同(contract)”这个业务分类，具体到“XXX产品服务合同”就是“合同(contract)”这个业务分类的一条数据。
---

## 创建自定义对象

管理员登录进入系统后点击右上角的“⚙”--“设置”进入设置界面，当我们需要创建自定义对象时点击“对象设置”->"对象”界面右上角的“新建”按钮。

 ![](https://console.steedos.cn/api/files/images/Tadsy6eNHKtnYGHRW)

* **数据源**：选择该对象所属数据源，该对象的数据将保存到指定数据源中，默认数据源使用的是mongodb数据库。
* **显示名**：界面上将显示该名称来表示该对象。
* **API名称**：字段唯一标识符，只能包含小写字母、数字，必须以字母开头，不能以下划线字符结尾或包含两个连续的下划线字符。
* **图标：** 为您的对象选择合适的图标。
* **开发状态**：此对象的开发状态，“开发中”的对象只有管理员才可以访问，当对象相关功能已经就绪时，您应该把它设置为“已部署”。
* **备注**：输入此对象的描述。
* **外部数据源**：引用第三方数据库的数据。
* **功能开关**：设置此对象上开放的功能，勾选表示开启相关功能。
* **脚本**：表单事件的脚本，例如：在“数据变化时”中添加脚本实现字段级联（联动）效果。

### 设置对象字段

新建对象后，您需要进一步描述该对象有哪些属性，比如对于 “报价(offer)” 对象，您可能希望新建“报价编号(offer_id)“、”到期日期(offer_date)“、”报价名称(offer_name)“等字段。


**自定义字段**

新建的对象，默认只有4个字段，即“名称(name)”、“所有者(owner)”、“创建人(created_by)”、“修改人(modified_by)”。例如我们需要添加一个 ”报价名称” 字段，点击右上角的 “新建” 按钮弹出 “编辑 对象字段”窗口，填写必填项显示名称 ”报价名称“ 、字段名 “offer_name” 、字段类型 “文本”，点击提交即完成一个字段的创建。

 ![](https://console.steedos.cn/api/files/images/vj7CJWqxyWy2sGcMG)

* **所属对象**：该字段所属对象，默认为当前对象。
* **显示名称**：字段最终显示的名称，由用户自定义。
* **字段名**：用来保存到数据库的字段名称，名称只能包含小写字母，数字，必须以字母开头。不能以下划线结尾或包含两个连续的下划线符号。
* **字段类型**：根据需求设置该字段的类型。
* **默认值**：设定字段的默认值，可以是固定值。
* **字段分组**：在记录的显示页面和编辑页面，将字段分组显示。
* **外部数据源**：引用第三方数据库的数据。
* **高级**：字段功能设置，比如该字段设置为必填。

### 字段显示公式

在高级-字段显示公式：该字段增加显示条件，示例：`{{formData.type__c === 'leader' ? true: false}}`，当字段type__c等于leader值时，才显示当前字段，否则隐藏该字段。

### 与关联表建立联系

以“报价(offer)”对象为例，我们可能希望描述每份报价关联客户是谁，此时我们可以新建一个“客户(client)”对象与之关联，关于如何创建业务对象关联的方法请阅览[相关表字段类型](/docs/admin/field_type#%E7%9B%B8%E5%85%B3%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B)

### 建立主表/子表关系

在相关表字段的基础上，可以额外设置两个对象间的主表/子表关系，比如 “报价(offer)” 中可能需要引用 ”业务机会“ 对象，字段类型设置为主表/子表，引用 “业务机会“ 对象 。使用方法和相关表一样，区别在于设置为主表/子表类型的字段可以在“相关子表”里设置关联子表显示的列。有关如何使用的详情信息请阅览[主表/子表字段类型](/docs/admin/field_type#%E4%B8%BB%E8%A1%A8%E5%AD%90%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B)

### 配置列表视图

列表视图是用来定义前台数据列表展示的数据，您可以自定义需要显示的字段，从不同的维度定义视图展示不一样的数据，设定筛选条件和排序规则等参数。例如“报价(offer)”对象，您可能希望有一个“我的报价”列表视图来展示“报价编号(offer_id)”、“报价名称(offer_name)”、“报价客户(offer_client)”、“状态(state)”等多个数据。用户在界面上可以很方便快捷的切换列表视图、添加筛选条件、查找数据、新建视图等等。[如何自定义列表视图](/docs/admin/create_object#%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE)

### 配置按钮

每个对象内置了在一定条件下才会显示的基础按钮，例如: 新建、编辑按钮。您也可以给指定对象配置自定义操作按钮。从”设置 => 对象设置 => 对象“进入指定的对象设置详情页， 然后找到操作按钮子表，点击右上角新建按钮，输入显示名称、API名称等后点击提交即可。

其中执行的脚本需要按照以下格式要求填写脚本代码，所有脚本都应该写入一个 `function`函数体内。

```javascript
function(object_name, record_id){
  // 在这里补充按钮点击事件业务需求脚本。
  // object_name : 对象名
  // record_id   : 记录ID 
}
```

* **当按钮显示记录详细页**：可以调用 `this.record` 、`Creator.getObjectRecord()` 获取当前记录信息。
* **当按钮显示在列表上**：可以调用 `gridRef.current.api.getSelectedRows()` 获取当前选中的记录。

### 关于对象功能开关

* **允许搜索**：此对象可以通过全局检索查询。
* **允许上传附件**：此对象可以上传附件。
* **允许添加任务**：此对象中的业务数据，可以添加任务。
* **允许添加备注**：此对象中的业务数据，可以添加备忘。
* **允许添加事件**：此对象中的业务数据，可以添加任务。
* **允许共享记录**：启用此功能可以设置该对象对于其他对象的记录共享。
* **允许配置对象流程**：只有启用此功能的业务对象，才能显示在对象流程的配置菜单中。
* **允许查看申请单**：此对象中的业务数据，可以进行审批。
* **允许添加留言**：用户对数据可以添加留言。
* **记录字段历史**：启用此功能后系统会自动记录此字段的修改记录。
* **允许编辑单个字段**：只有启用此功能的业务对象，才能单个编辑字段数据。
* **启用树状结构显示记录**：当启用时，与此对象关联的查找字段将以树状结构的形式显示其选项。
* **启用弹出窗口查找模式**：当启用时，与此对象关联的查找字段将以弹出窗口的形式显示其选项。

### 关于对象权限

您可以设置该对象的权限，包括简档对该对象的操作权限，禁用列表视图、禁用操作、不可见字段、不可编辑字段、禁用关联对象等等。有关对象权限详细介绍请阅览[对象权限](/docs/admin/create_object#%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90)

## 列表视图

**概述**

列表视图是用来定义前台数据列表展示的数据，您可以自定义需要显示的字段，从不同的维度定义视图展示不一样的数据，设定筛选条件和排序规则等参数。例如“报价(offer)”对象，可以定义所有报价、我的报价等多个视图。 用户在界面上可以很方便快捷的切换列表视图、添加筛选条件、查找数据、新建视图等等。

 ![](https://console.steedos.cn/api/files/images/Wzq3zoMPBFbwPbwD5)

### 如何创建列表视图

新建的对象默认有两个列表视图，分别是：所有和最近查看。默认展示的数据只有“名称”一个字段。当用户需要添加新视图的时候，可以进入对象详情界面找到“列表视图”-->“新建”弹出“新建 列表视图”窗口。填写必填项显示名称“所有报价”、API名称“offer_view”、对象“报价”、过滤范围“工作区”、并把需要显示的列添加上去，设置它的宽度和是否换行。

 ![](https://console.steedos.cn/api/files/images/NsiDe2kcaLmx3kkaH)

* **显示名称**：最终视图在界面中展示的名称。
* **API名称**：该名称作为API名称是唯一标识符，只能包含小写字母、数字，必须以字母开头，不能以下划线字符结尾或包含两个连续的下划线字符。
* **对象**：该视图所属的对象，默认为当前对象。
* **过滤范围**：有“工作区”和“我的”两个范围供用户选择，默认为“工作区”，用户也可以调整修改为“我的”，两者的区别在于“工作区”以当前整个工作区作为数据查找范围，而“我的”则只显示owner为当前登录用户的相关数据；
* **显示条目数**：在视图名称右侧显示该视图一共有多少条数据。
* **显示的列**：选择您需要展示的字段，并设置它的宽度和是否换行，点击下方的“新增一行”可以添加新的字段，若没有勾选 “是否换行”，表格中文字将始终显示为单行且超出部分显示省略号；
* **默认过滤的字段**：过滤用户选择的字段不显示在视图中。
* **默认排序规则**：选择您需要排序的字段，并指定排序方式（正序或者倒序），如果未配置，将按创建时间倒序来显示列表数据。
* \*\*手机端显示的列：\*\*选择手机端需要展示的字段。
* \*\*排序号：\*\*各个列表视图按排序号由小到大显示在列表左上角的弹窗中。


”所有“列表视图对应的API名称为 `all` , 该视图俗称 `all 视图` 。

* 当我们进入对象列表页时，如果没有新增列表视图或者修改已有列表视图的排序号, 默认显示的就是 `all 视图`；
* 当一个”相关表“类型字段展示选项的模式是弹出窗口查找模式，弹出窗口中的列表视图就是 `all 视图` ；
* 当给对象配置了一个”主表子表“类型字段，该对象详细记录页中的相关子表显示的就是 `all 视图` ,  如果给对象[配置页面布局](#%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80)，可以新建一个当前相关子表显示的列表视图。

### 调整显示的列

可以调整在列表视图中显示的列字段。

* 不显示某字段

如果不想显示某字段，删除这一显示的列即可。

* 调整字段显示顺序

如果想要调整列字段的显示先后顺序


 ![](https://console.steedos.cn/api/files/images/o4RnpqCab7HoszC9H)点击这个列字段的图标，并上下拖动即可。


* 增加显示字段

如果想要增加显示某字段，则点击“+ 新建”，并在新增的这一行选择字段，可以设置宽度，也可以拖动调整显示顺序。

### 调整默认过滤字段

默认过滤字段，是指列表视图右侧过滤器界面中的默认显示字段。将常用于过滤数据的字段设置为默认过滤字段后，用户即可在视图中更方便地进行过滤。

可以选择多个过滤字段，拖拉调整显示的次序。

### 调整默认排序规则

可以设置按多个字段的正序或倒叙显示列表视图中的数据。如果不设置默认排序规则，将按创建时间倒序来显示列表数据。

可以新建多条排序规则，并选择字段即排序方式。通过拖拉行，调整多个规则的先后顺序。

### 调整手机端显示的列

如果不特别设置手机端显示的列，则在华炎魔方的手机端，会默认显示“显示的列”中最前面的4个字段。也可以自主设置，来调整在手机端上需要显示的字段。

### 如何添加过滤条件

 ![](https://console.steedos.cn/api/files/images/NtfNZJqFfA9f2NHx6)列表视图的过滤条件并不是在后台对象设置中配置，而是在前台用户界面的对象列表视图右侧的过滤器中配置，上述截屏动画描述了给“任务”对象的自定义列表视图“紧急任务”添加过滤条件并保存为列表视图默认过滤条件的过程。

## 页面布局

在创建对象时，我们已经给对象增加了相应的字段，系统会自动生成对象记录的详情显示页面。

### 默认显示页面

系统默认的详情显示页面，主要包括以下内容：

* 对象信息，按字段的排序号，显示所有字段的值
* 操作按钮，包括：新建、编辑、删除等
* 相关子表的记录列表，并附新建按钮

如果希望修改这个显示页面，就可以自定义页面布局。

### 新建页面布局

 ![](https://console.steedos.cn/api/files/images/KoLia3v33FxMPaD96)              ![](https://console.steedos.cn/api/files/images/ru3Boe5u7saDG9XYi)

其中，简档可选择“用户”

> 每个页面布局都需对应一个简档，关于内置/自定义简档的详情，会在后续课程中展开。这里，先理解为：每个用户都属于一个简档；除管理员外，其他用户都默认属于用户这个简档。

### 配置操作按钮

 ![](https://console.steedos.cn/api/files/images/GNcw9zGmjjWXNQutX)

 ![](https://console.steedos.cn/api/files/images/nyvgQvXWkBzo59EPS)新建页面布局时，会默认加上新建、编辑、删除等操作按钮。可以按需要去除按钮，也可以给按钮设置显示条件的公式。

### 配置显示字段

新建页面布局时，会默认加上所有的字段。如果想隐藏某字段，在该字段的这一行，点击最右侧的三角图标、选择删除即可。

如果某字段之前已被隐藏，也可以通过“+ 新建”并选择此字段，来将此字段恢复显示。

 ![](https://console.steedos.cn/api/files/images/ardLNmdHx3kL2BGf4)

### 调整字段的显示顺序

点击字段最左侧的图标，并上下拖动，就能调整字段的显示顺序。

 ![](https://console.steedos.cn/api/files/images/uz8KQRKj69Lghw7oc)

### 调整字段的属性

在字段的这一行，可以修改字段的属性，包括只读、必读、分组等。也可以设置字段的显示条件字段，只有满足这一条件，该字段才会显示出来。

### 配置相关子表

默认列出所有的相关子表。可以删除当前某个子表，也可以点击左下角的“新建”按钮增加一个子表。每个子表中可以设置显示标题、显示的字段、排序字段等。

* 显示标题：默认取该子表对象名作为当前的显示标题。
* 显示的字段：默认取该子表对象的”所有“列表视图中的字段作为当前子表显示的字段。系统内置对象会自动将该对象中”所有“列表视图中显示的字段填充在此；自定义对象不会填充对应的字段，但其是生效的。

 ![](https://console.steedos.cn/api/files/images/5qxpbqMg4Y8gmpPJ2)

 ![](https://console.steedos.cn/api/files/images/gR3dc23TJESy88bSK)

### 不显示相关子表

新建页面布局时，会默认将该对象的所有子表对象加为相关子表。如果在显示该对象的详情信息时，并不想同时列出某个子对象的列表记录，可以在页面布局中删除这个相关子表项。在该相关子表的这一行，点击最右侧的三角图标、选择删除即可。

### 调整相关子表的显示顺序

点击相关子表最左侧的图标，并上下拖动，就能调整相关子表在详情页的显示顺序。


 ![](https://console.steedos.cn/api/files/images/gNGqZgbBhhPtz7gzt)

### 调整相关子表的属性

在相关子表的这一行，可以修改相关子表的属性，包括：

* 显示标题
* 显示的字段
* *排序字段*
* *排序方式*
* 每页显示数量

## 对象权限

对象的操作权限包括查看、创建、编辑、删除。举例来说，当用户点击“删除”按钮时，系统会校验用户所属简档和权限集下的所有对象权限的设置：如果对当前对象有“删除”的操作权限，则可以进行下一步操作；反之则不能继续操作。

**哪里可以设置对象权限？**

在对象设置详情页、简档和权限集里，都可以设置对象权限。 在对象设置详情页中对象权限子表中，点击权限集前面的序号或右侧下拉框中的编辑即可修改对象权限。对简档和权限集进行设置，也是同样的方式。

**如何创建对象权限？**

在对象设置详情页、简档和权限集，都可以新建对象权限。在对象设置详情页的对象权限子表右上角可以看到新建按钮，点击即可进行创建。 在权限集输入框选择将要授权的权限集，选择将要授权的对象，设定某类用户对特定对象的所拥有的操作权限。对简档和权限集进行设置，也是同样的方式。

 ![](https://console.steedos.cn/api/files/images/nHqRmGtdFXWtrpyGW)

* **允许查看** 勾选后，supplier可以查看合同对象相关信息。
* **允许创建** 勾选后，supplier有权限在合同对象里面创建一条合同记录。
* **允许编辑** 勾选后，supplier有权限对合同信息进行编辑。
* **允许删除** 勾选后，supplier有删除合同对象的权限。
* **查看所有记录** 勾选后，supplier可以查看所有的合同记录，通常可以为管理员配置此权限。
* **修改所有记录** 勾选后，supplier可以修改所有的合同记录，通常可以为管理员配置此权限。
* **查看本分部** 勾选后，supplier只能查看所属分部的合同记录，普通用户通常设置为此权限。
* **修改本分部** 勾选后，supplier只能修改本分部的合同记录，普通用户通常设置为此权限。

以上各对象权限选项的意义也可以参考此图。

 ![](https://console.steedos.cn/api/files/images/mu25NaG96reg7zxha)

* **查看指定分部** 启用后，将可以查看指定分部信息。
* **修改指定分部** 启用后，将可以修改指定分部信息。
* **禁用列表视图** 启用后，将不能看到对象的这些列表视图。例如，普通用户可以禁用“所有记录”这一项，而只展示“我的记录”这一项列表视图。
* **附件权限：控制附件的增删改查**。

**权限叠加规则**

虽然每个用户只属于一个简档，但是可能同时属于多个权限集，当一个用户属于多个权限集时，实际拥有的权限为各权限集权限的叠加。权限叠加规则请参考下图。

 ![](https://console.steedos.cn/api/files/images/wYeJQGXkkgPqRicDx)

**如何撤销用户权限**

如果要撤销某个用户的权限，一般有两种方式：一是在对象设置详情页中对象权限子表或简档或权限集里面，把对象权限的范围缩小，比如不允许创建、不允许编辑或删除等，但这样做，同时也缩小了属于此简档的其他用户的权限。第二种是把这个用户移出权限集，再重新为他配置特定的权限集权限。

## 创建自定义应用

建立好合同、付款等对象后，我们可以建立自定义应用：合同。

**新建应用：合同**

管理员，进入 设置》应用程序》应用程序，点击新建按钮

 ![新建应用程序](https://console.steedos.cn/api/files/images/pLbYpE4EiFdJ4mpSP)

输入应用程序的名称、API名称等，选择好桌面主菜单、手机主菜单，点击保存按钮。

 ![](https://console.steedos.cn/api/files/images/3gQZyGj6z97KiJ5F2)

**试用合同应用**

建立自定义应用后，就可以进入应用，查看这个应用的具体情况了。

**进入应用：合同**

点击左上角的“应用程序启动器”图标，可以点击进入合同应用。

 ![](https://console.steedos.cn/api/files/images/RnnzvrFFBiDPQ7cTc)

里面已经有之前在预览时录入的数据。

 ![](https://console.steedos.cn/api/files/images/W8BCSZWifA255kjMg)

查看合同详情页，不但显示合同的详情，也会将作为子表的付款记录列表显示。

 ![](https://console.steedos.cn/api/files/images/MeeMHihvzbdMzTkPW)

经过上述的配置，我们就建立起了合同管理系统的框架。具备了合同应用的基本功能，比如管理合同，建立和跟踪合同的付款记录等。

## 软件包

经过上述步骤我们初步实现了合同应用的构架，我们还可以进一步通过安装软件包的方式来丰富合同管理系统的功能，比如安装报表软件包`@steedos-labs/stimulsoft-reports`来设计合同报表，或者安装其他应用软件包，比如项目管理软件包以增加项目管理模块等。

要安装软件包，请在“设置”应用中进入“应用程序→软件包”界面并点击右上角的应用商城来浏览和购买软件包，购买后的软件包可以在这里点击“安装已购买应用”来一键安装，安装后就可以在系统中使用这些软件包功能了。

你也可以把本地开发好的软件包发布到华炎魔方私有的NPM仓库，即 <https://registry.steedos.cn/>，然后通过“手动安装软件包”按钮来安装自己发布的软件包，详情请参阅教程 [软件包发布与安装](/docs/developer/package)。

 ![](https://console.steedos.cn/api/files/images/jfFM2FsxzjnLAH6tb)

## 选项卡

华炎魔方新加了选项卡功能，设置好的选项卡会显示在页面顶部的Tab导航上，需要在“设置”应用中进入“应用程序→选项卡”来配置选项卡。

* 显示名称：选项卡的显示名称。
* API名称：选项卡的api名称。
* 图标：选项卡要额外显示的图标。
* 类型：选项卡类型，目前支持“对象”、“外部链接”和“页面”。
* 对象：从下拉菜单中选择该选项卡要关联到哪个对象上。
* 外部链接：该选项卡要关联到的URL地址，可以输入相对地址也可以输入绝对地址。
* 页面：从下拉菜单中选择该选项卡关联的页面。
* 显示在手机菜单中：是否显示在手机菜单中。
* 显示在桌面菜单中：是否显示在桌面菜单中。
* 描述：可以在这里输入选项卡备注。

### 对象选项卡

当选项卡类型为“对象”时，需要配置其要关联的对象，当用户在顶部导航点击该选项卡时会显示对象主页。

### 外部链接选项卡

当选项卡类型为“外部链接”时，需要配置其要跳转到的链接地址，这里可以输入系统内的相关地址，也可以输入外部的绝对地址。

值得一提的是在外部链接属性中输入的地址是支持 [开发人员快速向导](/docs/developer/getting-started) 中提到的 [表单公式](/docs/developer/getting-started#%E8%A1%A8%E5%8D%95%E5%85%AC%E5%BC%8F) 这种公式脚本的，当需要给地址配置动态参数时可以通过设置公式脚本来实现。

通常来说我们会使用这种类型的选项卡来显示第三方应用，我们通常也会在这里输入带参数的仪表盘的访问地址，以向用户展示带参数的仪表盘报表，格式为`/builder/[?动态参数，以p_开头]#/page/public/${pageApiName}[?hidden_title]`，详细请参考 [仪表盘开发向导](/docs/developer/dashboard)。

### 页面选项卡

这里的页面指的就是仪表盘，当我们想在应用中展示开发好的仪表盘报表时就需要配置该类型的选项卡，不过这种类型的选项卡只能配置出不带参数的仪表盘，需要指向带参数的仪表盘的话，只能使用上面提到的外部链接选项卡，详细请参考 [仪表盘开发向导](/docs/developer/dashboard)。

## 统计分析

我们经常需要在系统中开发各种报表来展示统计分析数据，比如上面我们开发好的合同应用就可能会需要展示每年月度收款金额对比曲线图。

目前华炎魔方已经集成了各种功能强大样式丰富的报表分析工具，详细请参考 [分析您的数据](/docs/admin/reports)。